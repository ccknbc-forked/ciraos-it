
name: Ciraos_Dynamic_Client_Worker

cleaninterval: 1000*60

hotpatch:
  - https://raw.githubusercontent.com/ChenYFan/ClientWorker/gh-pages/cw.js
  - https://cdn.jsdelivr.net/gh/ChenYFan/ClientWorker/cw.js

hotconfig:
  - https://blog.ciraos.top/config.yaml
  - https://raw.githubusercontent.com/ciraos/ciraos-octo/main/config.yaml
  - https://github.com/ciraos/ciraos-octo/blob/main/config.yaml

catch_rules:
  - rule: _
    transform_rules:
      # - search:
      #   replace:
      #     - blog.ciraos.top
      #     - _
      #   action: fetch
      #   fetch:
      #     status: 200
      #     engine: parallel
      #     preflight: false
      #     timeout: 30000
      #     delay: 4000
      - search: _ 
        action: fetch
        fetch:
          engine: fetch 
      - search: (^4|^5) 
        searchin: status 
        action: return
        return:
          body: 呐呐呐~~页面不显示了，请联系管理员哦~~~
          status: 503

  #! 静态资源 CDN 选择
  - rule: ^https\:\/\/((cdn|test1|quantil)\.jsdelivr\.net\/npm|npm\.elemecdn\.com|unpkg\.com)
    transform_rules:
      - search: _
        replace:
          - https://unpkg.com
          - https://npm.elemecdn.com 
          - https://npm.sourcegcdn.com 
          - https://cdn.bilicdn.tk/npm 
          - https://cdn.staticfile.org
          - _
        action: fetch
        fetch:
          status: 200
          engine: parallel
          preflight: false
          timeout: 3000
          cache:
            expire: 1000*60*60*8
            delay: 300

  #! 不劫持（丢给浏览器）
  #! 2.8.1新增，跳过cw规则
  #! （现在已经不再需要，但为了兼容性和避免未知bug建议留下此配置）
  - rule: .*
    transform_rules:
      - search: _
        action: skip
